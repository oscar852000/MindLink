---
name: prompt
description: æç¤ºè¯ç®¡ç†è§„èŒƒã€‚å½“ä»»åŠ¡æ¶‰åŠä¿®æ”¹æç¤ºè¯ã€AI ç³»ç»ŸæŒ‡ä»¤ã€æˆ– prompts.py æ–‡ä»¶æ—¶è‡ªåŠ¨åŠ è½½ã€‚
---

# æç¤ºè¯ç®¡ç†è§„èŒƒ

**æ–‡æ¡£ç»´æŠ¤å£°æ˜**ï¼šæœ¬æ–‡æ¡£å¯ä»¥ä¿®æ”¹ã€‚å¦‚æœå‘ç°å†…å®¹ä¸å®é™…ä¸ç¬¦ã€è¿‡æ—¶ã€æˆ–æœ‰é”™è¯¯ï¼Œå¿…é¡»ä¿®æ”¹ã€‚ä½†ä¿æŒç²¾ç®€ï¼Œé¿å…è‡ƒè‚¿ã€‚

## æ ¸å¿ƒåŸåˆ™

æ‰€æœ‰æç¤ºè¯é›†ä¸­åœ¨ `api/prompts.py`ï¼Œè¿™æ˜¯**å”¯ä¸€çœŸç†æº**ã€‚

```
prompts.py (å”¯ä¸€çœŸç†æº)
    â”‚
    â”œâ”€â”€ PROMPT_REGISTRY: æç¤ºè¯å…ƒæ•°æ® + é»˜è®¤å†…å®¹
    â”‚
    â””â”€â”€ get_prompt(key): è·å–æç¤ºè¯ï¼ˆæ•°æ®åº“ > é»˜è®¤å€¼ï¼‰
```

**è·å–ä¼˜å…ˆçº§**ï¼šæ•°æ®åº“è‡ªå®šä¹‰ > prompts.py é»˜è®¤å€¼

---

## æç¤ºè¯æ¸…å•

| å‰ç«¯åŠŸèƒ½ | æç¤ºè¯ Key | åå°æ˜¾ç¤ºå |
|---------|-----------|-----------|
| æŠ•å–‚ | `cleaner` | æŠ•å–‚ |
| å™äº‹ | `narrative_with_meta` | å™äº‹ |
| è¾“å‡º | `expresser` | è¾“å‡º |
| å¯¹è¯ | `chat_base` | å¯¹è¯ |
| å¯¹è¯é£æ ¼ | `chat_style_*` | å¯¹è¯é£æ ¼-xxx |
| æ€ç»´å¯¼å›¾ | `mindmap` | æ€ç»´å¯¼å›¾ |
| è®°å¿†é”šç‚¹ | `memory_anchor` | è®°å¿†é”šç‚¹ |

---

## æ­£ç¡®ä½¿ç”¨æ–¹å¼

```python
# âœ… æ­£ç¡®ï¼šä» prompts.py å¯¼å…¥
from api.prompts import get_prompt

system_prompt = get_prompt("cleaner")
```

---

## ç¦æ­¢äº‹é¡¹

| ç¦æ­¢è¡Œä¸º | åŸå›  |
|----------|------|
| åœ¨ ai_service.py å®šä¹‰æç¤ºè¯å¸¸é‡ | ç ´åå•ä¸€çœŸç†æº |
| åœ¨ chat_service.py å®šä¹‰ DEFAULT_PROMPTS | é€ æˆå¤šå¤„å®šä¹‰ |
| ç¡¬ç¼–ç æç¤ºè¯å­—ç¬¦ä¸² | æ— æ³•é€šè¿‡åå°ç®¡ç† |
| ç»•è¿‡ get_prompt() ç›´æ¥è¯»å– | ä¸¢å¤±æ•°æ®åº“ä¼˜å…ˆçº§é€»è¾‘ |

---

## AI æœåŠ¡å‡½æ•°å¯¹åº”

| å‡½æ•° | ç”¨é€” | æç¤ºè¯ Key |
|------|------|-----------|
| `clean_and_update_structure()` | å»å™ª + æ›´æ–°ç»“æ„ | `cleaner` |
| `generate_narrative_with_meta()` | ç”Ÿæˆå™äº‹è§†å›¾ | `narrative_with_meta` |
| `generate_output()` | æŒ‰æŒ‡ä»¤ç”Ÿæˆè¡¨è¾¾ | `expresser` |
| `generate_mindmap_from_timeline()` | ç”Ÿæˆæ€ç»´å¯¼å›¾ | `mindmap` |

---

## ä¿®æ”¹æç¤ºè¯çš„æ­£ç¡®æµç¨‹

1. **ç¡®è®¤ä½ç½®**ï¼šä¿®æ”¹ `api/prompts.py` ä¸­çš„ `PROMPT_REGISTRY`
2. **æˆ–ä½¿ç”¨åå°**ï¼šé€šè¿‡ `/admin` é¡µé¢ä¿®æ”¹ï¼ˆä¼šå­˜å…¥æ•°æ®åº“ï¼‰
3. **æµ‹è¯•**ï¼šä¿®æ”¹åæµ‹è¯•ç›¸å…³åŠŸèƒ½æ˜¯å¦æ­£å¸¸
4. **ä¸è¦**ï¼šåœ¨ä¸šåŠ¡ä»£ç ä¸­ç¡¬ç¼–ç æç¤ºè¯

---

## è¯¦ç»†æ–‡æ¡£

ğŸ“– æ›´å¤šç»†èŠ‚è§ [docs/PROMPT_GUIDE.md](../../../docs/PROMPT_GUIDE.md)
